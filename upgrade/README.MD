This is a spike of rewriting CDF upgrade by Golang.